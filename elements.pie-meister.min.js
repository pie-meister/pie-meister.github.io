customElements.define("pie-chart",class extends HTMLElement{connectedCallback(){this.attachShadow({mode:"open"});setTimeout((()=>this.render()))}render(t=this.getAttribute("colors")||["#e24","#2a4","#fe2","#46e","#f92"],e=~~this.getAttribute("pull")||0,s=~~this.getAttribute("gap")||0,i=0,r="http://www.w3.org/2000/svg",l=0){this.shadowRoot.innerHTML=`<style>:host{display:inline-block}svg{width:100%}</style><svg id=${this.id} xmlns=${r} viewBox="0 0 ${1e3+e} ${1e3+e}">${this.innerHTML}</svg>`;this.slices=[...this.shadowRoot.querySelectorAll("slice")].map(((o,a)=>{let h=o.getAttribute("size"),n=~~h.replace(/\%/,""),u=(~~o.getAttribute("stroke-width")||~~this.getAttribute("stroke-width")||(1e3+e)/2)-e;n==h?l||[...this.querySelectorAll("slice")].map((t=>l+=~~t.getAttribute("size")+s)):l=360;this.slice=(s,a=o.getAttribute("stroke")||t.shift(),h=u,c=(500+e/2)/2-e/2+s,b=document.createElementNS(r,"path"))=>(b.setAttribute("d",`m${500+e/2} ${500+e/2}m0 ${-c}a1 1 0 000 ${2*c}a1 1 0 000-${2*c}`),b.setAttribute("pathLength",l),b.setAttribute("fill","none"),b.setAttribute("stroke-width",h),b.setAttribute("stroke",a),b.setAttribute("stroke-dasharray",n+" "+(l-n)),b.M=()=>b.getPointAtLength(b.getTotalLength()-b.getTotalLength()/l*(i+n/2)),b);let c=this.slice(0),b=c.M(),d=this.slice(u/2,o.getAttribute("border")||this.getAttribute("border"),10),A=this.slice(Math.abs(e),0).M(),g=this.slice(this.getAttribute("text")||60,0).M(),p=document.createElementNS(r,"g"),m=document.createElementNS(r,"text"),w=o.hasAttribute("pull");c.onmouseover=()=>c.dispatchEvent(new Event(this.id,{bubbles:1,composed:1}));i+=n+s;c.setAttribute("stroke-dashoffset",i);d.setAttribute("stroke-dashoffset",i);[...o.attributes].map((t=>c.setAttribute(t.name,t.value)));m.setAttribute("x",g.x);m.setAttribute("y",g.y);m.innerHTML=o.innerHTML||h;p.append(c,m,d);p.id="slice"+(a+1);o.parentNode.replaceChild(p,o);c.slice={p:c,c:b,l:m,pull:t=>p.setAttribute("transform",t?`translate(${A.x-b.x} ${A.y-b.y})`:"translate(0 0)")};c.slice.pull(w);return c.slice}))}});