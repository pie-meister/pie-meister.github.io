<html>
  <head>
    <script src="./demo_assets/prism.js"></script>
    <link rel="stylesheet" href="./demo_assets/prism.css" data-noprefix />
    <script type="module">
      import PieMeister1 from "https://qomponents.github.io/class/PieMeister.min.js";
      // import PieMeister2 from "./PieMeister.min.js";
      // import PieMeister3 from "./PieMeisterInteractive.js";
      // import PieMeister4 from "./PieMeister.js";
      // import PieMeisterProgress from "./PieMeisterProgress.js";
      customElements.define("pie-chart", PieMeister1);
      // customElements.define("progress-circle", PieMeisterProgress);
    </script>
    <script src="./demo_assets/elements.pie-meister.site-elements.js"></script>
    <template id="PIE-DEMO">
      <style>
        :host {
          display: inline-block;
        }
        div {
          display: grid;
          grid-template-columns: var(--description-fr, 1fr) 3fr 2fr;
          gap: 1em;
        }
      </style>
      <div>
        <slot name="description"></slot>
        <slot name="html"></slot>
        <slot></slot>
      </div>
    </template>
    <template id="PIE-EXAMPLE">
      <style>
        :host {
          display: inline-block;
        }
        div {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1em;
        }
      </style>
      <div>
        <slot name="html"></slot>
        <slot></slot>
      </div>
    </template>
    <style>
      body {
        --pie-demo-background: #e2e2e2;
        --pie-demo-body-background:#222222;
        --pie-demo-body-color:lightgrey;
        --pie-demo-attr-background:grey;
        --pie-demo-attr-color:black;
        --pie-prism-background:hsla(20, 20%, 100%, 1);

        background: var(--pie-demo-body-background);
        color: var(--pie-demo-body-color);
        font-family: Arial;
        font-size: 14px;
        width:88vw;
        max-width:1100px;
        margin: 0 auto;
      }
      a{
        color:cornflowerblue;
      }
      [slot="html"]{
        background: var(--pie-prism-background)
      }
attr-setting{
        background:var(--pie-demo-attr-background);
        color:var(--pie-demo-attr-color);
      }
      pie-chart {
        max-width: 49vw;
        background: var(--pie-prism-background);
        aspect-ratio: 1/1;
        width: 100%;
        object-fit: contain;
        --dropsize: 2px;
      }
      .pi {
        font-size: 1.2em;
      }
      section > p{
        padding:0 1em;
      }
      .pie-code,
      pie-example,
      pie-demo {
        margin:1em;
        padding: 1em;
        background:var(--pie-demo-background,#e2e2e2);
        width:100%;
      }
      pie-example pre,
      pie-demo pre {
        margin:0;
        padding: 1em;
        overflow: auto;
        word-wrap: normal;
        white-space: pre;
      }
      pie-description {
        font-size: 1.2em;
        padding: 1em;
        color: var(--pie-demo-description-color,black);
      }
      header {
        /* display: grid;
        grid-template-columns: 1fr 1fr; */
        font-size: 1.5em;
      }
      header img {
        width: 100%;
      }
      header div {
        padding: 0 1em;
      }
      :not(:defined) {
        opacity: 0;
      }
      table{
        font-size:1em;
      }
      table a{
        text-decoration: none;
      }
      table content-length {
        padding-left: 3em;
        font-size: 1.1em;
        color:gold;
      }
      #about {
        font-size: 1.5em;
      }
    </style>
  </head>
  <body>
    <section>
      <header>
        <div>
          <br>
          <h1><meister-name></meister-name></h1>
          <p>
            [should place my original "Under Construction" web-site banner here, but haven't found my 1994 backups yet...]
          </p>
          <p>
            Todo: Write cool intro explaining how Web Components saved me from a unhealthy JSX addiction<br> and rekindled my love for semantic HTML.
          </p>
          <p>
            A client wanted to <b>draw pie charts easily</b>, and display them on a high volume fast web page.
          </p>
          <chart-libraries-table></chart-libraries-table>
        </div>
      </header>
    </section>
    <section>
      <h2>Load <meister-name></meister-name></h2>
      <p>
      No vendor lock. You can extend and built a Web Component with PieMeister
      as Base-Class. And Provide your own Custom Element name.
      <div class="pie-code">
      <pre class="language-html"><code >
      &lt;script type="module">
        import PieMeisterClass from 'https://qomponents.github.io/class/PieMeister.min.js';
        customElements.define( 'pie-chart' , PieMeisterClass );
      &lt;/script>
    </code></pre>
  </div>
</p>
    </section>

    <section>
      <h2>Then ALL HTML required is:</h2>
      <pie-example>
        <pie-chart id="pies" pulltext="100" pull="50" gap="0">
          <slice size="20%" stroke="#66cc33">Apple size</slice>
          <slice size="18%" stroke="#fc5a8d">Strawberry size</slice>
          <slice size="16%" stroke="#ff7518">Pumpkin size</slice>
          <slice size="10%" stroke="#790604">Cherry‍‍ size</slice>
          <slice size="5%" stroke="#4f86f7">Blueberry size</slice>
          <slice size="5%" stroke="#fff44f" pulltext="120" pull>
            Lemon size</slice
          >
          <slice size="5%" stroke="#d2691e">Chocolate size</slice>
          <slice size stroke="lightgrey">Other size</slice>
          <style>
            svg {
              background: grey;
            }
            [label] {
              font-size: 2em;
              text-anchor: middle;
              fill: blue;
            }
            [label*="Lemon"] text {
              fill: darkgoldenrod;
              font-size: 1.5em;
              font-weight: bold;
            }
          </style>
        </pie-chart>
      </pie-example>
    </section>
    <section>
      <h2><meister-name></meister-name> - documentation</h2>
      <pie-demo>
        <pie-chart id="pie1">
          <slice size="10"></slice>
          <slice size="20"></slice>
          <slice size="40"></slice>
          <slice size="10"></slice>
          <slice size="20"></slice>
          <slice size="40"></slice>
          <slice size="10"></slice>
        </pie-chart>
        <pie-description
          >Minimal HTML to hap<i class="pi">pi</i>ness.
          <p>Get 6 colors free</p></pie-description
        >
      </pie-demo>
      <pie-demo>
        <pie-chart>
          <slice size="10%"></slice>
          <slice size="20"></slice>
          <slice size="40"></slice>
        </pie-chart>
        <pie-description
          >Mark the <b>first</b> slice as a percentage
          <attr-setting>size="10%"</attr-setting> to create a 100 percent
          pie</pie-description
        >
      </pie-demo>
      <pie-demo>
        <pie-description
          >Specify the distance with <attr-setting>pull="100"</attr-setting> and
          which slice to pull<br /><br />The SVG has a default 1000 x 1000 units
          viewBox<br /><attr-setting>pull="100"</attr-setting> creates a
          1100x1100 viewBox so pulled slices are not cut off</pie-description
        >
        <pie-chart pull="100">
          <slice size="10" pull></slice>
          <slice size="20"></slice>
          <slice size="40"></slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description
          >Add a &lt;style> tag to activate labels. <br /><br />If a custom
          label is declared, the word 'size' is replaced. <br /><br />
          An empty slice auto-completes a <b>percentage pie</b></pie-description
        >
        <pie-chart>
          <style>
            text {
              font-size: 5em;
              text-anchor: middle;
            }
          </style>
          <slice size="10%"></slice>
          <slice size="20%">Red!</slice>
          <slice size="40%">size Blue!</slice>
          <slice size=""></slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description
          >Similar concept to <attr-setting>pull</attr-setting> <br /><br />
          <b>labels</b> can be pulled with
          <attr-setting>pulltext=</attr-setting> in or outward from the slice
          middle point</pie-description
        >
        <pie-chart pulltext="120">
          <style>
            text {
              font-size: 5em;
              text-anchor: middle;
            }
          </style>
          <slice size="10%"></slice>
          <slice size="20%"></slice>
          <slice size="40%" pulltext="-150"></slice>
          <slice size=""></slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description
          >Format a single slice <br /><br />
          See F12 console: There are plenty of extra attributes available to
          play with
        </pie-description>
        <pie-chart>
          <slice size="10%"></slice>
          <slice size="20%"></slice>
          <slice size="40%"></slice>
          <style>
            text {
              font-size: 5em;
              text-anchor: middle;
            }
            [slice="3"] {
              font-size: 1.5em;
              fill: red;
            }
          </style>
          <slice size=""></slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description>Add any SVG you want<br /><br /></pie-description>
        <pie-chart pull="30" pulltext="100">
          <circle r="505" cx="50%" cy="50%" fill="green"></circle>

          <slice size="10%"></slice>
          <slice size="20%"></slice>
          <slice size="40%"></slice>

          <circle r="100" cx="50%" cy="50%" fill="darkgreen"></circle>

          <slice size="0" stroke="grey">size to go!</slice>

          <text id="title" x="50%" y="50%" fill="white">Pie Meister</text>
          <style>
            text {
              font-size: 4em;
              text-anchor: middle;
            }
            #title {
              font-size: 8em;
            }
          </style>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description
          >Set the <attr-setting>(default) stroke-width="500"</attr-setting> to
          a <b>lower</b> value to create a Donut chart</pie-description
        >
        <pie-chart stroke-width="200">
          <slice size="10"></slice>
          <slice size="20"></slice>
          <slice size="40"></slice>
          <slice size="40"></slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description
          >A negative pull value <attr-setting>pull="-85"</attr-setting> makes
          the viewBox <b>smaller</b>, removing (unwanted) padding.
          <br /><br />The
          <attr-setting>&lt;slice size="20" pull></attr-setting> is
          <b>still</b> pulled outward</pie-description
        >
        <pie-chart stroke-width="200" pull="-85">
          <slice size="10"></slice>
          <slice size="20" pull></slice>

          <style>
            text {
              font-size: 4em;
              text-anchor: middle;
            }
          </style>

          <slice size="40"></slice>
          <slice size="40"></slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description
          >Slices can have different <attr-setting>pull</attr-setting> and
          <attr-setting>stroke-width</attr-setting> values.<br /><br />If you
          know SVG: all slice attributes will be copied to the SVG
          &lt;path></pie-description
        >
        <pie-chart stroke-width="200" pull="-140">
          <style>
            text {
              font-size: 4em;
              text-anchor: middle;
            }
          </style>
          <slice size="20" stroke-width="80">80</slice>
          <slice size="30" stroke-width="120">120</slice>
          <slice size="40" stroke-width="160">160</slice>
          <slice size="50" x="40">default 200</slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description
          ><attr-setting>fill="stroke-width"</attr-setting> on the
          &lt;pie-chart> makes the <attr-setting>stroke-width</attr-setting>
          <b>start</b> from the Pie Chart <b>center</b> creating a Polar
          chart</pie-description
        >
        <pie-chart fill="stroke-width" pull="50" pulltext="90">
          <style>
            text {
              font-size: 4em;
              text-anchor: middle;
            }
          </style>
          <slice size="4" stroke-width="300">300</slice>
          <slice size="1" stroke-width="200">200</slice>
          <slice size="1" stroke-width="300">300</slice>
          <slice size="1" stroke-width="400">400</slice>
          <slice size="1">500 default</slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description
          >Don't like the 6 default colors? Specify an array of colors:
          <attr-setting>stroke="blue,red,green"</attr-setting><br /><br />And/or
          color a slice <attr-setting>stroke="gold"</attr-setting>.
          <br /><br />The slice
          <attr-setting>stroke="gold"</attr-setting> 'saves' using a color from
          the <attr-setting>stroke</attr-setting> array</pie-description
        >
        <pie-chart pull="100" stroke="blue,red,green">
          <slice size="10" pull></slice>
          <slice size="40" stroke="gold"></slice>
          <slice size="20" pull></slice>
          <slice size="40"></slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description>Progress circle<br><br>Use SVG <attr-setting>tspan</attr-setting> (textspan) elements to create more complex labels.</pie-description>
        <pie-chart offset="top" pull="-250">
          <style>
            [slice="0"] text{
              display:none
            }
            path {
              stroke-linecap: round;
              stroke-width:15%;
              transition: 2s;
            }
            text{
              text-anchor:middle;
              alignment-baseline:middle;
              fill:black;
            }
            tspan:nth-of-type(1){
              font-size:80;
            }
            tspan:nth-of-type(2){
              font-size:150;
            }
          </style>
          <slice size="100%" stroke="grey"></slice>
          <slice size="70%"><tspan y=350>Progress</tspan><tspan x="400" y="500">size</tspan></slice>
        </pie-chart>
      </pie-demo>
      <hr>
      <style>
        progress-circle:nth-of-type(1) pie-chart::part(text){
          fill:hotpink;
        }
        progress-circle::part(chart)::part(label){
          font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
          fill:red;
        }
        progress-circle{
          background:blueviolet;
          width:160px;
        }
      </style>
      <progress-circle value="80%">default:green</progress-circle>
      <progress-circle value="10%" stroke="red">stroke=red</progress-circle>
      <progress-circle value="50%" width="50">width=50</progress-circle>
      <progress-circle value="25%" fill="lightgreen">fill=lightgreen</progress-circle>
      <progress-circle value="10%" color="red">color=red</progress-circle>
      <hr>
      <progress-circle base="pie-chart">
        <style>
          [slice="0"] [part="path"]{
            xfill:indianred;
          }
          path{
            transform: translate(0px,0px);
            }
          [part="label"]{
            font-size:180;
            fill:darkgreen;
          }
          [part="value"]{
            fill:black;
            transform: translate(100 0) scale(2);
          }
        </style>
        <progress value=75% width=70 stroke1="magenta">One</progress>
      </progress-circle>
      <hr>
      regular progress element
      <progress max=100 value="70">70%</progress>
    </section>
    <!-- <linearGradient id="greenish">
      <stop offset="0" stop-color="darkgreen"></stop>
      <stop offset="1" stop-color="green"></stop>
    </linearGradient> -->
    <!-- <slice id="percentage" size="70%" stroke="url(#greenish)"><tspan>SEO</tspan><tspan x="400" y="500">size</tspan></slice> -->
    <!-- <animate href="#percentage"
      attributeName="stroke-dasharray" begin="0.5s" values="-25;70" dur="1s" repeatCount="1" calcMode="linear" ></animate> -->
    <!-- <animate href="#percentage"
      attributeName="stroke-dashoffset" from="0,100" to="75,25"
      dur="1s" repeatCount="1" ></animate> -->
    




    <section>
      <h2><meister-name></meister-name> - interacting with a pie</h2>
      <p>
        [Sorry.. doesn't work in PieMeister ... but it does in the (private) PieMeisterInteractive Qomponent]
      </p>
      <p>
        Pie slices emit mouseenter & mouseout Events to the pie-chart Element
      </p>
      <pre><code class="language-javascript">
          pullpie.addEventListener("slice", (evt) => {
            let slice = evt.target.g; // SVG &lt;g> element with slice &lt;path> and &lt;text> label
            slice.pull(!slice.pulled)
          });
      </code></pre>
      <pie-demo>
        <pie-description></pie-description>
        <pie-chart id="pullpie" pull="100">
          <slice size="10" pull></slice>
          <slice size="40"></slice>
          <slice size="20" pull></slice>
          <slice size="40"></slice>

          <style>
            text {
              font-size: 4em;
              text-anchor: middle;
            }
          </style>
        </pie-chart>
      </pie-demo>
    </section>
    <section>
      <h2><meister-name></meister-name> - A<i>PI</i></h2>
      <!-- <pie-demo>
        <pie-description>
          <pre><code class="language-javascript">
            api.addEventListener("slice", (evt) => {
              let slice = evt.target.g; // SVG &lt;g> element
              slice.pull(!slice.pulled)
              console.log(`slice.pull(true/false) method`);
              //slice
              //slice.path
              //slice.create
              console.log(slice)
              slice.append("21")
            });
        </code></pre>
          </pie-description>
        <pie-chart id="api">
          <slice size="30"></slice>
          <slice size="20"></slice>
          <slice size="30"></slice>
        </pie-chart>
      </pie-demo> -->
    </section>
    <section>
      <h2><meister-name></meister-name> - Todo</h2>
      <ul>
        <li>Fix .createSlice</li>
        <li>document size=360 , or set fixed pathLength=100</li>
        <li>Document SVG &lt;tspan></li>
        <li>Document gap</li>
        <li>Document slice.point( x , y , z)</li>
      </ul>
    </section>
    <section>
      <h2><meister-name></meister-name> - Notes</h2>
      <ul>
        <li>&lt;circle /> self-closing tags do not work</li>
        <li>
          A &lt;slice> is converted to a SVG &lt;path> which can
          <b>not</b> contain HTML<br />
          <pre>
&lt;slize size="10">&lt;span> HTML here breaks the SVG &lt;/span>&lt;/slice></pre
          >
        </li>
        <li>
          The word <b>'size'</b> in a <b>label</b> is replaced with the
          <attr-setting>slice size</attr-setting><br />
          To prevent replacing regular words with the string 'size', add the (no
          space width) WordJoiner unicode character
          <attr-setting>&amp;#8288;</attr-setting> <br />so the replace code
          never finds the word 'size';
          <pre class="language-html"><code>
              &lt;pie-chart>
                &lt;slice size="20%">Big si&amp;#8288;zed Apple (size)&lt;/slice>  &lt;!-- Big sized Apple (20%) -->
                &lt;slice size="15%">Small si&amp;#8288;zed Apple (size)&lt;/slice> &lt;!-- Small sized Apple (15%) -->
              &lt;/pie-chart>
            </code></pre>
        </li>
        <li>
          Fun fact: <meister-name></meister-name> does not use any Pi
          calculations!
        </li>
      </ul>
    </section>
    <section hidden>
      <pie-chart
        id="rounded"
        pull="-50"
        xgap="2"
        stroke-width="200"
        xstroke-linecap="round"
        stroke="red"
      >
        <defs>
          <filter id="round">
            <feGaussianBlur
              in="SourceGraphic"
              stdDeviation="1.5"
              result="blur"
            ></feGaussianBlur>
            <feColorMatrix
              in="blur"
              mode="matrix"
              values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9"
              result="blurred"
            ></feColorMatrix>
            <feComposite
              in="SourceGraphic"
              in2="blurred"
              operator="atop"
            ></feComposite>
          </filter>
        </defs>
        <slice size="45" stroke="blue"></slice>
        <slice size="90" stroke="orange"></slice>
        <slice size="45" stroke="rebeccapurple"></slice>
        <slice size="45" stroke="gold"></slice>
        <slice size="45" stroke="firebrick" pull></slice>
        <!-- <circle r="30" cx="50%" cy="50%" fill="beige"></circle> -->
      </pie-chart>
    </section>
    <section>
      <h2><meister-name></meister-name> - Experiments</h2>
      <pie-demo>
        <pie-description>CSS filter styles all SVG elements.</pie-description>
        <pie-chart pull="200" pulltext="300">
          <style>
            svg {
              background: transparent;
              filter: drop-shadow(5px 0px 0px darkgreen);
            }
            text {
              font-size: 4em;
              text-anchor: middle;
            }
          </style>
          <slice size="10%"></slice>
          <slice size="20%" pulltext="1" pull></slice>
          <slice size="40%">Label</slice>
          <slice size="30%"></slice>
        </pie-chart>
      </pie-demo>
      <pie-demo>
        <pie-description>Recreating Google Analytics multiple percentages</pie-description>
        <pie-chart id="GoogleAnalytics" offset="top">
          <style>
            text {
              font-size: 4em;
              text-anchor: middle;
            }
            path {
              stroke-linecap: round;
              stroke-width:10%;
            }

          </style>
          <slice size="100%" stroke="grey"></slice>
          <slice size="75%" x="50%" y="50%">SEO</slice>
          <slice size="60%">Social</slice>
          <slice size="65%">Maps</slice>
          <slice size="50%">Traffic</slice>
        </pie-chart>
      </pie-demo>
    </section>
    <section>
      <h2>
        <meister-name></meister-name> - GZip analysis - Can you squeeze out more
        bytes?
      </h2>
      <img src="gzip_analysis.png" />
      <!-- <img src="https://www.rgraph.net/images/svg-activity-meter-snippet.png"> -->
    </section>
  </body>
</html>
